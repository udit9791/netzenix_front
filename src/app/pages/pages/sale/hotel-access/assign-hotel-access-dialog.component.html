<div class="p-4 w-full">
  <div class="text-lg font-semibold mb-3">Assign Hotel Access</div>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <mat-form-field appearance="outline">
      <mat-label>Select User</mat-label>
      <input
        matInput
        [formControl]="userCtrl"
        [matAutocomplete]="userAuto"
        placeholder="Type user name or email"
      />
      <mat-autocomplete #userAuto="matAutocomplete" [displayWith]="displayUser">
        <mat-option *ngFor="let u of filteredUsers$ | async" [value]="u">
          {{ u.label }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:col-span-2">
      <mat-form-field appearance="outline">
        <mat-label>Country</mat-label>
        <mat-select [formControl]="countryCtrl">
          <mat-option [value]="null">Select Country</mat-option>
          <mat-option *ngFor="let c of countries" [value]="c.id">{{ c.name }}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>State</mat-label>
        <mat-select [formControl]="stateCtrl">
          <mat-option [value]="null">Select State</mat-option>
          <mat-option *ngFor="let s of states" [value]="s.id">{{ s.name }}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>City</mat-label>
        <mat-select [formControl]="cityCtrl">
          <mat-option [value]="null">Select City</mat-option>
          <mat-option *ngFor="let ci of cities" [value]="ci.id">{{ ci.name }}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <mat-form-field appearance="outline">
      <mat-label>Add Hotels</mat-label>
      <input
        matInput
        [formControl]="hotelQueryCtrl"
        [disabled]="!selectedCountryId || !selectedStateId || !selectedCityId"
        [matAutocomplete]="hotelAuto"
        placeholder="Search and add hotels"
      />
      <mat-autocomplete
        #hotelAuto="matAutocomplete"
        (optionSelected)="addHotel($event.option.value)"
        [displayWith]="displayHotel"
      >
        <mat-option *ngFor="let h of filteredHotels$ | async" [value]="h">
          {{ h.label }}
        </mat-option>
      </mat-autocomplete>
      <mat-hint *ngIf="!selectedCountryId || !selectedStateId || !selectedCityId">
        Select Country, State and City to enable hotel search
      </mat-hint>
    </mat-form-field>
  </div>

  <div class="mt-3">
    <div class="text-sm text-gray-600 mb-1">Selected Hotels:</div>
    <div class="flex flex-wrap gap-2">
      <div class="px-2 py-1 border rounded flex items-center gap-2" *ngFor="let h of selectedHotels">
        <span>{{ h.name }}</span>
        <button mat-icon-button (click)="removeHotel(h.id)" aria-label="Remove">
          <mat-icon>close</mat-icon>
        </button>
      </div>
    </div>
  </div>

  <div class="mt-4 flex justify-end gap-2">
    <button mat-button (click)="cancel()">Cancel</button>
    <button mat-flat-button color="primary" (click)="save()">Save</button>
  </div>
</div>

